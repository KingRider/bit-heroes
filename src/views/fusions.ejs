<%- include('familiars-filters') %>
<table class="table table-bordered familiars">
  <thead>
    <tr>
      <th id="count" title="<%= locals.count %> fusions"><%= locals.count %></th>
      <th id="type" class="asc focus">Type</th>
      <th id="name" class="asc">Name</th>
      <th id="power" class="asc">Power&nbsp;(%)</th>
      <th id="stamina" class="asc">Stamina&nbsp;(%)</th>
      <th id="agility" class="asc">Agility&nbsp;(%)</th>
      <th id="skill1" class="asc">Skill 1</th>
      <th id="skill2" class="asc">Skill 2</th>
      <th id="skill3" class="asc">Skill 3</th>
      <th id="skill4" class="asc">Skill 4</th>
      <th id="skill5" class="asc">Skill 5</th>
      <th id="passiveAbility" class="asc">Passive ability</th>
      <th id="fusion" class="asc">Fusion</th>
    </tr>
  </thead>
  <tbody>
    <% for (let i = 0; i < locals.data.length; i++) { %>
    <tr id="<%= locals.data[i].name.replace(/ /g, '') %>"
    class="<%= locals.data[i].type.toLowerCase() %>"
    data-raw-passive-abilities="<%= locals.data[i].rawPassiveAbilities %>"
    data-raw-skills="<%= locals.data[i].rawSkills %>"
    data-raw-fusion="<%= locals.data[i].rawFusion %>">
      <td><img src="<%= locals.data[i].avatar %>" alt=""></td>
      <td><%= locals.data[i].type %></td>
      <td><%= locals.data[i].name %></td>
      <td><%= locals.data[i].power %></td>
      <td><%= locals.data[i].stamina %></td>
      <td><%= locals.data[i].agility %></td>
      <% for (let j = 0; j < 5; j++) { %>
      <td>
        <% if (locals.data[i].skills[j]) { %>
          <%= locals.data[i].skills[j].name %> (<%= locals.data[i].skills[j].skillPoint %>&nbsp;SP)<br><b><%= locals.data[i].skills[j].action %></b><br><%= locals.data[i].skills[j].pourcentage %>
        <% } %>
      </td>
      <% } %>
      <td>
        <ul>
          <% for (let j = 0; j < locals.data[i].passiveAbility.length; j++) { %>
          <li><%= locals.data[i].passiveAbility[j].pourcentage %> <b><%= locals.data[i].passiveAbility[j].ability %></b></li>
          <% } %>
        </ul>
      </td>
      <td>
        <ul>
        <% for (let j = 0; j < locals.data[i].fusion.length; j++) { %>
          <% if (
            locals.data[i].fusion[j].name.includes('Gold')
            || locals.data[i].fusion[j].name.includes('Material')
            || locals.data[i].fusion[j].name.includes('Sprocket')
            || locals.data[i].fusion[j].name.includes('Syrum')
            || locals.data[i].fusion[j].name.includes("Hobbit's Foot")
            || locals.data[i].fusion[j].name.includes('Demon Juice')
            || locals.data[i].fusion[j].name.includes('Wet Brainz')
            || locals.data[i].fusion[j].name.includes('Ninja Powah')
            || locals.data[i].fusion[j].name.includes('Ginger Snaps')
            || locals.data[i].fusion[j].name.includes('Jelly Donut')
            || locals.data[i].fusion[j].name.includes('Ectoplasm')
            || locals.data[i].fusion[j].name.includes('Demon Hide')
            || locals.data[i].fusion[j].name.includes('Bacon')
            ) { %>
          <li><%= new Intl.NumberFormat().format(locals.data[i].fusion[j].count) %> <%= locals.data[i].fusion[j].name %></li>
          <% }
          else
          {
            const name = locals.data[i].fusion[j].name
            let url = 'familiars'
            if (locals.data.find(data => data.name === name)) {
              url = 'fusions'
            } %>
          <li><%= locals.data[i].fusion[j].count %> <a href="/<%= url %>#<%= locals.data[i].fusion[j].name.replace(/ /g, '') %>"><b><%= locals.data[i].fusion[j].name %></b></a></li>
          <% } %>
        <% } %>
        </ul>
      </td>
    </tr>
    <% } %>
  </tbody>
  <tfoot>
    <tr>
      <th id="count" title="<%= locals.count %> fusions"><%= locals.count %></th>
      <th id="type" class="asc focus">Type</th>
      <th id="name" class="asc">Name</th>
      <th id="power" class="asc">Power (%)</th>
      <th id="stamina" class="asc">Stamina (%)</th>
      <th id="agility" class="asc">Agility (%)</th>
      <th id="skill1" class="asc">Skill 1</th>
      <th id="skill2" class="asc">Skill 2</th>
      <th id="skill3" class="asc">Skill 3</th>
      <th id="skill4" class="asc">Skill 4</th>
      <th id="skill5" class="asc">Skill 5</th>
      <th id="passiveAbility" class="asc">Passive ability</th>
      <th id="fusion" class="asc">Fusion</th>
    </tr>
  </tfoot>
</table>
