<%- include('familiars-filters') %>
<p class="reroll-formula"></p>
<table class="table table-bordered">
  <thead>
    <tr>
      <th id="count" title="<%= locals.count %>"><%= locals.count %></th>
      <th id="type" class="asc focus">Type</th>
      <th id="name" class="asc">Name</th>
      <th id="moveSpeed" class="asc number">Move&nbsp;speed&nbsp;(%)</th>
      <th id="bonus" class="asc">Bonus</th>
      <th id="skill" class="asc">Skill</th>
      <th id="purchase" class="asc">Purchase</th>
      <th id="upgrade1" class="asc" title="Upgrade 1">Upgrade&nbsp;1</th>
      <th id="upgrade2" class="asc" title="Upgrade 2">Upgrade&nbsp;2</th>
      <th id="upgrade3" class="asc" title="Upgrade 3">Upgrade&nbsp;3</th>
      <th id="upgrade4" class="asc" title="Upgrade 4">Upgrade&nbsp;4</th>
      <th id="upgradeTotal" class="asc" title="Upgrade Total">Upgrade&nbsp;∑</th>
      <th id="exchange1" class="asc" title="Exchange 1">Exchange&nbsp;1</th>
      <th id="exchange2" class="asc" title="Exchange 2">Exchange&nbsp;2</th>
      <th id="exchange3" class="asc" title="Exchange 3">Exchange&nbsp;3</th>
      <th id="exchange4" class="asc" title="Exchange 4">Exchange&nbsp;4</th>
      <th id="exchange5" class="asc" title="Exchange 5">Exchange&nbsp;5</th>
    </tr>
  </thead>
  <tbody>
    <% for (let i = 0; i < locals.data.length; i++) { %>
    <tr id="<%= locals.data[i].name.replace(/ /g, '') %>" class="<%= locals.data[i].type.toLowerCase() %>">
      <td><img src="<%= locals.data[i].avatar %>" alt=""></td>
      <td><%= locals.data[i].type %></td>
      <td><%= locals.data[i].name %></td>
      <td><%= locals.data[i].moveSpeed %></td>
      <td><%= locals.data[i].bonus %></td>
      <td><%= locals.data[i].skill %></td>
      <td>
        <% for (let j = 0; j < locals.data[i].purchase.length; j++) { %>
          <%= new Intl.NumberFormat().format(locals.data[i].purchase[j][0].count) %> <span class="material <%= locals.data[i].purchase[j][0].material.toLowerCase().replace(' ', '-') %>" title="Gold"><%= locals.data[i].purchase[j][0].material %></span><br>
          <%= locals.data[i].purchase[j][1].count %> <span class="material mount-guts" title="Mounts Guts"><%= locals.data[i].purchase[j][1].material %></span><br>
          <%= locals.data[i].purchase[j][2].count %> <span class="material <%= locals.data[i].purchase[j][2].material.toLowerCase().replace(' ', '-') %>" title="<%= locals.data[i].purchase[j][2].material %>"><%= locals.data[i].purchase[j][2].material %></span>
        <% } %>
      </td>
      <%
      let gutsTotal = 0
      let materialTotal = 0
      let material = ''
      for (let j = 0; j < 4; j++) { %>
      <td>
        <% if (locals.data[i].upgrades[j]) { %>
          <%
          gutsTotal += Number(locals.data[i].upgrades[j][0].count)
          materialTotal += Number(locals.data[i].upgrades[j][1].count)
          material = locals.data[i].upgrades[j][1].material
          %>
          <%= locals.data[i].upgrades[j][0].count %> <span class="material mount-guts" title="Mounts Guts"><%= locals.data[i].upgrades[j][0].material %></span><br>
          <%= locals.data[i].upgrades[j][1].count %> <span class="material <%= locals.data[i].upgrades[j][1].material.toLowerCase().replace(' ', '-') %>" title="<%= locals.data[i].upgrades[j][1].material %>"><%= locals.data[i].upgrades[j][1].material %></span>
        <% } %>
      </td>
      <% } %>
      <td>
        <%= gutsTotal %><span class="material mount-guts" title="Mounts Guts"><%= 'Mount guts' %></span><br>
        <%= materialTotal %> <span class="material <%= material.toLowerCase().replace(' ', '-') %>" title="<%= material %>"><%= material %></span>
      </td>
      <% for (let j = 0; j < 5; j++) { %>
      <td>
        <% if (locals.data[i].exchanges[j]) { %>
          <%= locals.data[i].exchanges[j][0].count %> <span class="material mount-guts" title="Mounts Guts"><%= locals.data[i].exchanges[j][0].material %></span><br>
          <%= locals.data[i].exchanges[j][1].count %> <span class="material <%= locals.data[i].exchanges[j][1].material.toLowerCase().replace(' ', '-') %>" title="<%= locals.data[i].exchanges[j][1].material %>"><%= locals.data[i].exchanges[j][1].material %></span>
        <% } %>
      </td>
      <% } %>
    </tr>
    <% } %>
  </tbody>
  <tfoot>
    <tr>
      <th id="count" title="<%= locals.count %>"><%= locals.count %></th>
      <th id="type" class="asc focus">Type</th>
      <th id="name" class="asc">Name</th>
      <th id="moveSpeed" class="asc number">Move&nbsp;speed&nbsp;(%)</th>
      <th id="bonus" class="asc">Bonus</th>
      <th id="skill" class="asc">Skill</th>
      <th id="purchase" class="asc">Purchase</th>
      <th id="upgrade1" class="asc" title="Upgrade 1">Upgrade&nbsp;1</th>
      <th id="upgrade2" class="asc" title="Upgrade 2">Upgrade&nbsp;2</th>
      <th id="upgrade3" class="asc" title="Upgrade 3">Upgrade&nbsp;3</th>
      <th id="upgrade4" class="asc" title="Upgrade 4">Upgrade&nbsp;4</th>
      <th id="upgradeTotal" class="asc" title="Upgrade Total">Upgrade&nbsp;∑</th>
      <th id="exchange1" class="asc" title="Exchange 1">Exchange&nbsp;1</th>
      <th id="exchange2" class="asc" title="Exchange 2">Exchange&nbsp;2</th>
      <th id="exchange3" class="asc" title="Exchange 3">Exchange&nbsp;3</th>
      <th id="exchange4" class="asc" title="Exchange 4">Exchange&nbsp;4</th>
      <th id="exchange5" class="asc" title="Exchange 5">Exchange&nbsp;5</th>
    </tr>
  </tfoot>
</table>
